<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <title>Practice site</title>
  <meta name="description" content="Web-based algorithmic generation of interactive music">
  <meta name="author" content="Ryan Carter">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" href="./tonemotion-shared/css/styles-1.4.0.css">
  <link rel="icon" type="image/png" href="tonemotion-shared/img/favicon.ico">
</head>
<body>

  <header>
    <h1>Practice site</h1>
    <button id="help_button" type="button">?</button>
  </header>

  <main> <!-- center panel showing app status, messages, controls -->
    <div id="status_container">
      <p id="status_label">loading</p>
    </div>
    <div class="center-btn-wrapper">
      <button id="shake_test_button" type="button" class="practice hidden">practice shake</button>
      <button id="tilt_test_button" type="button" class="practice hidden">practice tilt</button>
    </div>
    <!-- button is not displayed until page loads, then shows "start" -->
    <!-- then button shows "stop" unless error, which shows "try again" and programmatically reloads page -->
    <!-- when piece is done, button goes away -->
    <button id="start_stop_button" type="button" class="transport hidden"></button>
    <div id="message_container" class="hidden">
      <p id="message_label"> </p>
    </div>

    <!-- hidden <audio> element coerces iOS into playing audio when ring/silent switch is on silent-->
    <audio id="silent_buffer">
      <source src="tonemotion-shared/audio/silent-buffer-to-set-audio-session.mp3">
    </audio>

    <!-- append sliders and "shake" button here -->
    <fieldset id="sliderFieldset" class="hidden">
      <legend>Motion simulation</legend>
      <label for="x_slider">X-axis of accelerometer</label>
      <input type="range" id="x_slider" name="accel_x" min="0" max="1" step="0.01" />
      <label for="y_slider">Y-axis of accelerometer</label>
      <input type="range" id="y_slider" name="accel_y" min="0" max="1" step="0.01" />
      <button id="simulateShakeButton" type="button">shake device</button>
    </fieldset>

  </main>

  <section id="help_panel" class="slide-out"> <!-- left panel with instructions and help -->
    <div>
      <h2>Instructions</h2>
      <p>This site allows you to practice the participatory component of the works that the Boise Phil will premiere on May 7 and May 14, 2022. There will also be a short explanation and opportunity to practice just before each performance, and you really don't need to practice at all, but if you would like to see how the audience participation works, you can use this site.</p>
      <p>During each piece, you will be able to control sounds on your phone, either by shaking your phone or by tilting it. The particular sounds you can make will change depending on what the musicians are playing.</p>
      <p>During a section marked "shake," you can trigger sounds by shaking your phone. Just flicking your wrist gently will play a sound, in this case just a short click. If you hold your phone still, it will not make sound.</p>
      <p>During a section marked "tilt," you can control sounds by holding your phone in different positions. In this case, the tone you hear will be muted when your phone is upright, but will get louder and brighter as you tip your phone upside down. Additionally, you can control the note that you play. When you tilt your phone to the left, it will play lower notes, and when you tilt your phone to the right, it will play higher notes.</p>
    </div>
    <div>
      <h2>Compatibility and accessibility</h2>
      <!-- note to self - tested Feb. 1, 2019 on iPhone 6s and it works, but does not work on iPhone 5 -->
      <p>Compatible with iOS and Android. Older models and devices that have not been recently updated may not be supported. Recommended browsers are Safari and Chrome. (Please note that a bug in the version of Safari included with iOS 13.4 prevents the "shake" mode of interactivity from functioning; updating to any later version of iOS fixes the issue.)</p>
      <p>I hope that the site I have designed is maximally accessible to all users. If you have thoughts on improving the accessibility of this site, please feel free to contact me at ryan (at) ryancarter (dot) org.</p>
    </div>
    <div>
      <h2>Motion monitor</h2>
      <input type="checkbox" id="motion_data_checkbox">
      <label for="motion_data_checkbox">Show motion data (may affect performance)</label>
      <div id="motion_container" class="hidden">
        <p id="motion_data_label"></p>
      </div>
    </div>
    <div id="publicConsole">
      <h2>Console</h2>
      <input type="checkbox" id="console_checkbox">
      <label for="console_checkbox">Show console messages (may affect performance)</label>
      <div id="console_container" class="hidden">
      </div>
    </div>
  </section>

  <!-- KEEP THIS VERSION OF Tone.js and don't link to different version -->
  <!-- They make trivial changes to Tone.js that will break older code -->
  <script src="tonemotion-shared/js/tone-builds/build-v14-7-77/Tone.js"></script>
  <!-- NoSleep.js prevents automatic screen lock, which chokes piece -->
  <script src="tonemotion-shared/js/NoSleep-v0-12-0.js"></script>
  <script src="tonemotion-shared/js/tonemotion-fixed-2.0.0.js"></script>

  <!-- Score for this piece -->
  <script src="tonemotion-shared/scores/practice.js"></script>

</body>
</html>
